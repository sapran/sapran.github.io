---
id: 1105
title: Почему нельзя работать в Windows под административным аккаунтом
date: 2009-07-22T20:00:00+00:00
author: sapran
layout: post
guid: http://styran.com/2009/07/22/%d0%bf%d0%be%d1%87%d0%b5%d0%bc%d1%83-%d0%bd%d0%b5%d0%bb%d1%8c%d0%b7%d1%8f-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0%d1%82%d1%8c-%d0%b2-windows-%d0%bf%d0%be%d0%b4-%d0%b0%d0%b4%d0%bc%d0%b8%d0%bd%d0%b8%d1%81/
permalink: /2009/07/%d0%bf%d0%be%d1%87%d0%b5%d0%bc%d1%83-%d0%bd%d0%b5%d0%bb%d1%8c%d0%b7%d1%8f-%d1%80%d0%b0%d0%b1%d0%be%d1%82%d0%b0%d1%82%d1%8c-%d0%b2-windows-%d0%bf%d0%be%d0%b4-%d0%b0%d0%b4%d0%bc%d0%b8%d0%bd%d0%b8%d1%81/
blogger_blog:
  - securegalaxy.blogspot.com
blogger_author:
  - Vlad Styran
blogger_permalink:
  - /2009/07/windows.html
blogger_internal:
  - /feeds/3388835630659782197/posts/default/4673650038595756560
shorturl:
  - http://tinyurl.com/nw3l8ec
tags:
  - microsoft
  - uac
---
Как нередко (читай: всегда) бывает в этой индустрии, &#171;все дело в доверии&#187;™. Вы либо доверяете операционной системе, либо нет. Компания доверяет своему сотруднику (и наоборот), или не очень. Заказчик доверяет поставщику услуг (Интернет, телефонии, грузоперевозок), или выбирает другого поставщика. В каждом случае доверие играет ключевую роль. [Прав старина Шнайер](http://www.schneier.com/blog/archives/2009/06/cloud_computing.html) &#8212; в &#171;[облаке](http://en.wikipedia.org/wiki/Cloud_computing)&#187; нет ничего нового. Это просто очередное испытание для надежности модели, в которой один доверяет, а другой заслуживает доверия.

Выполняя программу с повышенными привилегиями, вы тем самым полностью доверяете ей вашу систему и все ее содержимое. Особенно это касается интерактивных сеансов работы, когда все окружение пользователя выполняется с правами администратора. Ну например, что может случиться. Вам приходит письмо с вложением в формате PDF. Вы открываете его своим дырявым Adobe Reader 9.0.0, который успешно эксплойтится содержащимся в PDF-е куском JavaScript и в результате выполняет произвольный код с правами эксплуатируемго приложения. То есть с правами пользователя, который это приложение запустил. С вашими правами. Если в этот момент вы &#171;[ограниченный пользователь](http://www.microsoft.com/protect/computer/advanced/useraccount.mspx)&#187; (что вряд ли), то возможно ваши файлы будут удалены или размещены на Imageshack/YouTube. То есть, произойдет нечто, ограниченное вашими правами доступа.

Если же Adobe Reader выполнялся с правами локального администратора, то на вашем ПК откуда ни возьмись возникнет [бот](http://en.wikipedia.org/wiki/Spambot), рассылающий всей планете рекламу виагры или раздающий порнуху по bittorrent. Страшно подумать о том, что будет, если вместо локального админа это произойдет с админом доменным. В этом случае под удар попадает чуть ли не вся ИТ-инфраструктура компании.

Из этого делаем вывод: нечего запускать ненадежный софт из-под админа. В том числе и ненадежные компоненты ОС, такие как визуальная среда. И в особенности &#8212; программы-лидеры обнаруживаемых уязвимостей безопасности: Adobe Flash и семейство Acrobat, Sun Java и Microsoft Office. Полноценно использовать систему и ПО можно и с ограниченными правами, а если что-то вдруг потребует эскалации привилегий &#8212; воспользуйтесь пунктом контекстного меню Run as&#8230; и укажите логин/пароль администратора. Для облегчения этого процесса существуют чудесные операционные системы Windows 7 и Vista, там оно вполне доделано, а в &#171;семерке&#187; еще и причесано. Несчастным пользователям ископаемых ОС типа Windows NT, 98, Me и XP предлагаю воспользоваться утилитой [ShellRunAs](http://en.wikipedia.org/wiki/Spambot), поставляемой в составе горячо мною любимого [Sysinternals Suite](http://technet.microsoft.com/en-us/sysinternals/bb842062.aspx).

Кстати, [UAC](http://en.wikipedia.org/wiki/User_Account_Control), по вине которого первая в истории здоровая ОС от Microsoft (да-да, я имею в виду Vista) заслужила славу &#171;назойливого г-на&#187;, является официальным признанием мелкомягкими своего поражения в борьбе с повсеместным использованием пользователями административных привилегий. User Access Control действует так: каждый раз, когда какое-то приложение намыливается совершить изменения в ОС (записать на диск за пределами каталога пользователя, добавить значение в реестр и т.д.), UAC это намерение перехватывает и выносит на суд пользователя. Делает он это по-разному: переключаясь в Secure Desktop (это когда никуда из окна подтверждения не переключиться, а все вокруг становится темно-серым), запрашивая реквизиты более могущественного пользователя, либо просто выбрасывая окно подтверждения. Но бестолковые юзера, вместо того, чтобы [настроить уровень &#171;назойливости&#187; в меню Local Security Settings](http://www.walkernews.net/2007/06/28/vista-uac-setup-guide-in-local-security-policy/), эту супер-фичу обычно сразу отключают, чем превращают Vista из назойливого г-на в г-но унылое и ничем не отличающееся от своих предшественников. В &#171;семерке&#187;, к счастью, UAC замечательно настраивается из панели управления и есть шанс, что таким образом он получит лучшие отзывы.

На этом кланяюсь, и так заболтался. Думайте, кому доверяете.

<div class="addtoany_share_save_container addtoany_content_bottom">
  <div class="a2a_kit a2a_kit_size_32 addtoany_list a2a_target" id="wpa2a_36">
    <a class="a2a_button_facebook" href="http://www.addtoany.com/add_to/facebook?linkurl=https%3A%2F%2Fblog.styran.com%2F2009%2F07%2F%25d0%25bf%25d0%25be%25d1%2587%25d0%25b5%25d0%25bc%25d1%2583-%25d0%25bd%25d0%25b5%25d0%25bb%25d1%258c%25d0%25b7%25d1%258f-%25d1%2580%25d0%25b0%25d0%25b1%25d0%25be%25d1%2582%25d0%25b0%25d1%2582%25d1%258c-%25d0%25b2-windows-%25d0%25bf%25d0%25be%25d0%25b4-%25d0%25b0%25d0%25b4%25d0%25bc%25d0%25b8%25d0%25bd%25d0%25b8%25d1%2581%2F&linkname=%D0%9F%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%BD%D0%B5%D0%BB%D1%8C%D0%B7%D1%8F%20%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D1%82%D1%8C%20%D0%B2%20Windows%20%D0%BF%D0%BE%D0%B4%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D0%BC%20%D0%B0%D0%BA%D0%BA%D0%B0%D1%83%D0%BD%D1%82%D0%BE%D0%BC" title="Facebook" rel="nofollow" target="_blank"></a><a class="a2a_button_twitter" href="http://www.addtoany.com/add_to/twitter?linkurl=https%3A%2F%2Fblog.styran.com%2F2009%2F07%2F%25d0%25bf%25d0%25be%25d1%2587%25d0%25b5%25d0%25bc%25d1%2583-%25d0%25bd%25d0%25b5%25d0%25bb%25d1%258c%25d0%25b7%25d1%258f-%25d1%2580%25d0%25b0%25d0%25b1%25d0%25be%25d1%2582%25d0%25b0%25d1%2582%25d1%258c-%25d0%25b2-windows-%25d0%25bf%25d0%25be%25d0%25b4-%25d0%25b0%25d0%25b4%25d0%25bc%25d0%25b8%25d0%25bd%25d0%25b8%25d1%2581%2F&linkname=%D0%9F%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%BD%D0%B5%D0%BB%D1%8C%D0%B7%D1%8F%20%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D1%82%D1%8C%20%D0%B2%20Windows%20%D0%BF%D0%BE%D0%B4%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D0%BC%20%D0%B0%D0%BA%D0%BA%D0%B0%D1%83%D0%BD%D1%82%D0%BE%D0%BC" title="Twitter" rel="nofollow" target="_blank"></a><a class="a2a_button_google_plus" href="http://www.addtoany.com/add_to/google_plus?linkurl=https%3A%2F%2Fblog.styran.com%2F2009%2F07%2F%25d0%25bf%25d0%25be%25d1%2587%25d0%25b5%25d0%25bc%25d1%2583-%25d0%25bd%25d0%25b5%25d0%25bb%25d1%258c%25d0%25b7%25d1%258f-%25d1%2580%25d0%25b0%25d0%25b1%25d0%25be%25d1%2582%25d0%25b0%25d1%2582%25d1%258c-%25d0%25b2-windows-%25d0%25bf%25d0%25be%25d0%25b4-%25d0%25b0%25d0%25b4%25d0%25bc%25d0%25b8%25d0%25bd%25d0%25b8%25d1%2581%2F&linkname=%D0%9F%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%BD%D0%B5%D0%BB%D1%8C%D0%B7%D1%8F%20%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D1%82%D1%8C%20%D0%B2%20Windows%20%D0%BF%D0%BE%D0%B4%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D0%BC%20%D0%B0%D0%BA%D0%BA%D0%B0%D1%83%D0%BD%D1%82%D0%BE%D0%BC" title="Google+" rel="nofollow" target="_blank"></a><a class="a2a_button_linkedin" href="http://www.addtoany.com/add_to/linkedin?linkurl=https%3A%2F%2Fblog.styran.com%2F2009%2F07%2F%25d0%25bf%25d0%25be%25d1%2587%25d0%25b5%25d0%25bc%25d1%2583-%25d0%25bd%25d0%25b5%25d0%25bb%25d1%258c%25d0%25b7%25d1%258f-%25d1%2580%25d0%25b0%25d0%25b1%25d0%25be%25d1%2582%25d0%25b0%25d1%2582%25d1%258c-%25d0%25b2-windows-%25d0%25bf%25d0%25be%25d0%25b4-%25d0%25b0%25d0%25b4%25d0%25bc%25d0%25b8%25d0%25bd%25d0%25b8%25d1%2581%2F&linkname=%D0%9F%D0%BE%D1%87%D0%B5%D0%BC%D1%83%20%D0%BD%D0%B5%D0%BB%D1%8C%D0%B7%D1%8F%20%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D1%82%D1%8C%20%D0%B2%20Windows%20%D0%BF%D0%BE%D0%B4%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B8%D1%81%D1%82%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D0%BC%20%D0%B0%D0%BA%D0%BA%D0%B0%D1%83%D0%BD%D1%82%D0%BE%D0%BC" title="LinkedIn" rel="nofollow" target="_blank"></a><a class="a2a_dd addtoany_share_save" href="https://www.addtoany.com/share"></a>
  </div>
</div>