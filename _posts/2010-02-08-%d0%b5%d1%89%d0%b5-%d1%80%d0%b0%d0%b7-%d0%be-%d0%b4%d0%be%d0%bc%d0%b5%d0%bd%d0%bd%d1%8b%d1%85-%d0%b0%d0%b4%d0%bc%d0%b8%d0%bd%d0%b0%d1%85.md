---
id: 1054
title: Еще раз о доменных админах
date: 2010-02-08T19:55:00+00:00
author: sapran
layout: post
guid: http://styran.com/2010/02/08/%d0%b5%d1%89%d0%b5-%d1%80%d0%b0%d0%b7-%d0%be-%d0%b4%d0%be%d0%bc%d0%b5%d0%bd%d0%bd%d1%8b%d1%85-%d0%b0%d0%b4%d0%bc%d0%b8%d0%bd%d0%b0%d1%85/
permalink: /2010/02/%d0%b5%d1%89%d0%b5-%d1%80%d0%b0%d0%b7-%d0%be-%d0%b4%d0%be%d0%bc%d0%b5%d0%bd%d0%bd%d1%8b%d1%85-%d0%b0%d0%b4%d0%bc%d0%b8%d0%bd%d0%b0%d1%85/
blogger_blog:
  - securegalaxy.blogspot.com
blogger_author:
  - Vlad Styran
blogger_permalink:
  - /2010/02/blog-post.html
blogger_internal:
  - /feeds/3388835630659782197/posts/default/5295608064343647465
shorturl:
  - http://tinyurl.com/oowsjjv
tags:
  - active directory
  - dumb asses
  - антивирусы
  - менеджеры
  - пентесты
  - управление рисками
---
<div style="text-align: justify;">
  Услышал недавно два весьма забавных заблуждения.
</div>

<div style="text-align: justify;">
</div>

<div style="text-align: justify;">
  <b>Заблуждение первое</b>, молодое и бестолковое. В беседе с одним молодым коллегой пытался выяснить, что же по его мнению является успешным результатом тестирования на проникновение. Конкретного ответа не получил, вернее получил несколько неконкретных. Все они сводились к идее &#171;<b>root the box</b>&#171;, то есть получению&nbsp;привилегированных&nbsp;прав доступа к той или иной системе. Окей, говорю я, получил ты root, что дальше? В ответ изумленный взгляд и полное недоумение: как что дальше? Все! Разве этого мало?
</div>

<div style="text-align: justify;">
</div>

<div style="text-align: justify;">
  Мало. Представьте себе совершенно&nbsp;неосведомленного&nbsp;в вопросах ИТ (а тем более ИБ) генерального директора крупной (или не очень) компании. Как вы думаете, какое на него произведет впечатление заявление о том, что вам удалось получить доступ к учетной записи доменного администратора? Да никакого. У него этих доменных админов хоть пруд пруди, одним больше, одним меньше&#8230; Теперь другая ситуация, вы сообщаете ему, что вам удалось получить доступ к БД заказчиков и поставщиков, ERP-модулю&nbsp;заработной&nbsp;платы и кадрового учета, историческому хранилищу информации об обработанных кредитных картах&#8230; Да хотя бы к его корпоративному почтовому ящику! Скорее всего, эффект будет совершенно противоположным. Во втором случае бизнес-риски, сопряженные с получением доступа (не всегда обязательно &#8212; привилегированного), намного более очевидны. Именно поэтому критерием успешности теста на проникновение очень часто является получение доступа к бизнес критичным данным, а не просто получение доменного админа или root-а. Разумеется, административный аккаунт в этом деле не помешает, но он далеко не всегда необходим. Например, обладая доступом к ПК главного бухгалтера, о доменном админе обычно можно уже не беспокоиться.
</div>

<div style="text-align: justify;">
</div>

<div style="text-align: justify;">
  <b>Мнение второе</b>, закоренелое и самоуверенное. Полная противоположность предыдущему: ну и что, что у хакера есть доменный администратор? Что с того? Все наши критичные данные находятся на супер-защищенных серверах под управлением UNIX, да еще и в базах данных под не менее защищенным (ха-ха) Oracle. Я не стал обсуждать отдельные аспекты безопасности компании Oracle, в этом конкретном случае это, вероятно, было бы бесполезно. Вместо этого я тонко намекнул, что доменный администратор может установить любое ПО на рабочую станцию UNIX-администратора или Oracle DBA. В том числе и <b><a href="http://en.wikipedia.org/wiki/Keystroke_logging">keylogger</a></b> или <b><a href="http://en.wikipedia.org/wiki/Packet_analyzer">sniffer</a></b>. В ответ оппонент с гордостью заявил, что на каждом компьютере в его компании установлен мега-крутой антивирус. После моего замечания о том, что доменный админ скорее всего обладает правами на изменение настроек этого антивируса, гордости немного поубавилось.
</div>

<div style="text-align: justify;">
</div>

<div style="text-align: justify;">
  Вопрос не в том, нужен или не нужен злоумышленнику аккаунт с повышенными привилегиями для успешной компрометации системы. Вопрос в том, понимает ли бизнес и ИТ риски, сопряженные с использованием привилегированных учетных записей. В одном из предыдущих постов я излагал пример атаки, нацеленной на получение прав доменного администратора. На самом деле, это чисто теоретическое упражнение, потому что &#171;<b><a href="https://docs.google.com/viewer?url=https://www.defcon.org/images/defcon-16/dc16-presentations/defcon-16-valsmith_ames.pdf">root is just the beginning</a></b>&#171;. Получением административных прав взлом не заканчивается, он с него только начинается.
</div>

<div style="text-align: justify;">
</div>

<div style="text-align: justify;">
  Пользуйтесь <b>принципом наименьших достаточных привилегий</b>. Наделяйте пользователей только теми правами, которые необходимы им для выполнения служебных обязанностей. Используйте также <b>принцип обоснованной необходимости</b> в предоставлении доступа к данным. Если сотрудник не использует определенные данные в своей работе, то и доступ к ним ему предоставлять не обязательно. Следуйте этим&nbsp;принципам, и тогда даже в случае успешной&nbsp;компрометации&nbsp;системы,&nbsp;действия&nbsp;злоумышленника&nbsp;будут локализованы и он вряд ли получит доступ к данным, к которым не имеет доступа взломанный им аккаунт.
</div>

<div class="addtoany_share_save_container addtoany_content_bottom">
  <div class="a2a_kit a2a_kit_size_32 addtoany_list a2a_target" id="wpa2a_87">
    <a class="a2a_button_facebook" href="http://www.addtoany.com/add_to/facebook?linkurl=https%3A%2F%2Fblog.styran.com%2F2010%2F02%2F%25d0%25b5%25d1%2589%25d0%25b5-%25d1%2580%25d0%25b0%25d0%25b7-%25d0%25be-%25d0%25b4%25d0%25be%25d0%25bc%25d0%25b5%25d0%25bd%25d0%25bd%25d1%258b%25d1%2585-%25d0%25b0%25d0%25b4%25d0%25bc%25d0%25b8%25d0%25bd%25d0%25b0%25d1%2585%2F&linkname=%D0%95%D1%89%D0%B5%20%D1%80%D0%B0%D0%B7%20%D0%BE%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D1%85%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B0%D1%85" title="Facebook" rel="nofollow" target="_blank"></a><a class="a2a_button_twitter" href="http://www.addtoany.com/add_to/twitter?linkurl=https%3A%2F%2Fblog.styran.com%2F2010%2F02%2F%25d0%25b5%25d1%2589%25d0%25b5-%25d1%2580%25d0%25b0%25d0%25b7-%25d0%25be-%25d0%25b4%25d0%25be%25d0%25bc%25d0%25b5%25d0%25bd%25d0%25bd%25d1%258b%25d1%2585-%25d0%25b0%25d0%25b4%25d0%25bc%25d0%25b8%25d0%25bd%25d0%25b0%25d1%2585%2F&linkname=%D0%95%D1%89%D0%B5%20%D1%80%D0%B0%D0%B7%20%D0%BE%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D1%85%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B0%D1%85" title="Twitter" rel="nofollow" target="_blank"></a><a class="a2a_button_google_plus" href="http://www.addtoany.com/add_to/google_plus?linkurl=https%3A%2F%2Fblog.styran.com%2F2010%2F02%2F%25d0%25b5%25d1%2589%25d0%25b5-%25d1%2580%25d0%25b0%25d0%25b7-%25d0%25be-%25d0%25b4%25d0%25be%25d0%25bc%25d0%25b5%25d0%25bd%25d0%25bd%25d1%258b%25d1%2585-%25d0%25b0%25d0%25b4%25d0%25bc%25d0%25b8%25d0%25bd%25d0%25b0%25d1%2585%2F&linkname=%D0%95%D1%89%D0%B5%20%D1%80%D0%B0%D0%B7%20%D0%BE%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D1%85%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B0%D1%85" title="Google+" rel="nofollow" target="_blank"></a><a class="a2a_button_linkedin" href="http://www.addtoany.com/add_to/linkedin?linkurl=https%3A%2F%2Fblog.styran.com%2F2010%2F02%2F%25d0%25b5%25d1%2589%25d0%25b5-%25d1%2580%25d0%25b0%25d0%25b7-%25d0%25be-%25d0%25b4%25d0%25be%25d0%25bc%25d0%25b5%25d0%25bd%25d0%25bd%25d1%258b%25d1%2585-%25d0%25b0%25d0%25b4%25d0%25bc%25d0%25b8%25d0%25bd%25d0%25b0%25d1%2585%2F&linkname=%D0%95%D1%89%D0%B5%20%D1%80%D0%B0%D0%B7%20%D0%BE%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D1%85%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D0%B0%D1%85" title="LinkedIn" rel="nofollow" target="_blank"></a><a class="a2a_dd addtoany_share_save" href="https://www.addtoany.com/share"></a>
  </div>
</div>