---
id: 1070
title: Гранд-Каньон на пути к доменному админу
date: 2009-12-06T22:46:00+00:00
author: sapran
layout: post
guid: http://styran.com/2009/12/06/%d0%b3%d1%80%d0%b0%d0%bd%d0%b4-%d0%ba%d0%b0%d0%bd%d1%8c%d0%be%d0%bd-%d0%bd%d0%b0-%d0%bf%d1%83%d1%82%d0%b8-%d0%ba-%d0%b4%d0%be%d0%bc%d0%b5%d0%bd%d0%bd%d0%be%d0%bc%d1%83-%d0%b0%d0%b4%d0%bc%d0%b8%d0%bd/
permalink: /2009/12/%d0%b3%d1%80%d0%b0%d0%bd%d0%b4-%d0%ba%d0%b0%d0%bd%d1%8c%d0%be%d0%bd-%d0%bd%d0%b0-%d0%bf%d1%83%d1%82%d0%b8-%d0%ba-%d0%b4%d0%be%d0%bc%d0%b5%d0%bd%d0%bd%d0%be%d0%bc%d1%83-%d0%b0%d0%b4%d0%bc%d0%b8%d0%bd/
blogger_blog:
  - securegalaxy.blogspot.com
blogger_author:
  - Vlad Styran
blogger_permalink:
  - /2009/12/blog-post_07.html
blogger_internal:
  - /feeds/3388835630659782197/posts/default/2178047939923829933
shorturl:
  - http://tinyurl.com/omg9lvm
tags:
  - active directory
  - microsoft
  - sysinternals
  - пароли
  - сети
  - управление рисками
---
<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">Как и договаривались, привожу перечень противоядий описанному в </span></span>[<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">этом посте</span></span>](http://securegalaxy.blogspot.com/2009/12/blog-post.html)<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">. Следуя этим рекомендациям можно значительно понизить шансы злоумышленника повысить свои привилегии после успешного проникновения в корпоративную сеть. Я не буду напоминать о необходимости обновлять используемое ПО, здесь речь пойдет только об учетных записях и паролях к ним.</span></span>  
<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"><br /></span></span> <span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"> </span></span>  
**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">1. Минимизируйте количество пользователей с правами доменного администратора.</span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;Желательно до двух человек. Я серьезно. В </span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">Active Directory</span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;нет&nbsp;объективной&nbsp;необходимости раздачи этих прав во все стороны. Все функции, для выполнения которых в большинстве компании айтишникам выдают доменных админов, можно </span></span>**[<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">делегировать</span></span>](http://www.microsoft.com/downloads/details.aspx?familyid=631747a3-79e1-48fa-9730-dae7c0a1d6d3&displaylang=en)**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">.</span></span>  
<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"><br /></span></span> <span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"> </span></span>  
**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">2. Минимизируйте количество штатных пользователей с правами локального администратора.</span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"> Желательно до нуля. Локальный админ должен быть у специалистов техподдержки и агентов хелпдеска, &nbsp;ТЧК. Причем это должна быть учетная запись отличная от обычной, под которой пользователь входит в систему интерактивно.</span></span>  
<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"><br /></span></span> <span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"> </span></span>  
<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">Ну например, В.Пупкин &#8212; агент хелпдеска. У него есть логин </span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">vpupkin</span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">, под которым Василий входит в Windows на рабочем месте и запускает всяческое уязвимое ПО. В добавок к обычному аккаунту у Васи есть учетка </span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">vapupkin</span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">, которая состоит в доменной группе </span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">Local Admins</span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">, которая является подгруппой локальной группы </span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">Adminisrators</span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"> на всех ПК домена. Под ней он и помогает своим коллегам через </span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">Удаленный помощник, Run As&#8230; & </span></span>[<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">Shell RunAs</span></span>](http://technet.microsoft.com/en-us/sysinternals/cc300361.aspx)**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">. Такая политика обеспечивает уверенность в том, что по крайней мере случайно ничего катостофического не произойдет.</span></span>  
<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"><br /></span></span> <span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"> </span></span>  
**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">3. Не кешируйте пароли на ПК.</span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;Конечно же, вообще не кешировать пароли не выйдет, ведь пользователям нужно логиниться на ноутбуках и тогда, когда они не подключены к корпоративной сети. Не кешируйте хотя бы пароли привилегированных пользователей, насколько мне известно, это можно настроить при помощи групповых политик AD. Обычно в этом месте начинаются контраргументы типа &#171;А как в таком случае хелпдеску поддерживать удаленных пользователей?&#187; А никак. Пропишите в </span></span>[<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"><b>SLA</b></span></span>](http://en.wikipedia.org/wiki/Service_level_agreement)<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">, что поддержке полежат только ПК, подключенные к корпоративной сети. Не можете пойти на такие радикальные меры? Проведите анализ рисков и уточните приоритеты. Возможно, оказание помощи коллегам, находящимся &nbsp;в отпуске, для вас важнее, чем угроза возникновения прав доменного администратора в руках злоумышленника.</span></span>  
<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"><br /></span></span> <span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"> </span></span>  
**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">4. Размер имеет значение.</span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;Для брутфорса восьмисимвольного&nbsp;пароля необходимы вычислительные ресурсы&nbsp;</span></span>**[<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">Amazon EC2</span></span>](http://aws.amazon.com/ec2/)<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"> </span></span>**<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">стоимостью около 1,5 тысяч долларов. Не такая уж и серьезная сумма, не правда ли? Переводите домен на&nbsp;использование&nbsp;десяти-, а еще лучше, двенадцатисимвольных паролей. Сотрудники, которые в 2009 году испытывают сложности с выдумыванием длинных и сложных паролей, вероятно, прошли собеседование по ошибке. В качестве компенсации морального ущерба, проведите тренинг на тему&nbsp;персональной&nbsp;информационной безопасности и увеличьте срок истечения паролей, если у вас он меньше 90 дней.</span></span>  
<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"><br /></span></span> <span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;"> </span></span>  
<span style="font-size: small;"><span style="font-family: 'Trebuchet MS', sans-serif;">Всем удачи в вашем нелегком деле, каким бы оно ни было.</span></span>

<div class="addtoany_share_save_container addtoany_content_bottom">
  <div class="a2a_kit a2a_kit_size_32 addtoany_list a2a_target" id="wpa2a_71">
    <a class="a2a_button_facebook" href="http://www.addtoany.com/add_to/facebook?linkurl=https%3A%2F%2Fblog.styran.com%2F2009%2F12%2F%25d0%25b3%25d1%2580%25d0%25b0%25d0%25bd%25d0%25b4-%25d0%25ba%25d0%25b0%25d0%25bd%25d1%258c%25d0%25be%25d0%25bd-%25d0%25bd%25d0%25b0-%25d0%25bf%25d1%2583%25d1%2582%25d0%25b8-%25d0%25ba-%25d0%25b4%25d0%25be%25d0%25bc%25d0%25b5%25d0%25bd%25d0%25bd%25d0%25be%25d0%25bc%25d1%2583-%25d0%25b0%25d0%25b4%25d0%25bc%25d0%25b8%25d0%25bd%2F&linkname=%D0%93%D1%80%D0%B0%D0%BD%D0%B4-%D0%9A%D0%B0%D0%BD%D1%8C%D0%BE%D0%BD%20%D0%BD%D0%B0%20%D0%BF%D1%83%D1%82%D0%B8%20%D0%BA%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D0%BE%D0%BC%D1%83%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D1%83" title="Facebook" rel="nofollow" target="_blank"></a><a class="a2a_button_twitter" href="http://www.addtoany.com/add_to/twitter?linkurl=https%3A%2F%2Fblog.styran.com%2F2009%2F12%2F%25d0%25b3%25d1%2580%25d0%25b0%25d0%25bd%25d0%25b4-%25d0%25ba%25d0%25b0%25d0%25bd%25d1%258c%25d0%25be%25d0%25bd-%25d0%25bd%25d0%25b0-%25d0%25bf%25d1%2583%25d1%2582%25d0%25b8-%25d0%25ba-%25d0%25b4%25d0%25be%25d0%25bc%25d0%25b5%25d0%25bd%25d0%25bd%25d0%25be%25d0%25bc%25d1%2583-%25d0%25b0%25d0%25b4%25d0%25bc%25d0%25b8%25d0%25bd%2F&linkname=%D0%93%D1%80%D0%B0%D0%BD%D0%B4-%D0%9A%D0%B0%D0%BD%D1%8C%D0%BE%D0%BD%20%D0%BD%D0%B0%20%D0%BF%D1%83%D1%82%D0%B8%20%D0%BA%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D0%BE%D0%BC%D1%83%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D1%83" title="Twitter" rel="nofollow" target="_blank"></a><a class="a2a_button_google_plus" href="http://www.addtoany.com/add_to/google_plus?linkurl=https%3A%2F%2Fblog.styran.com%2F2009%2F12%2F%25d0%25b3%25d1%2580%25d0%25b0%25d0%25bd%25d0%25b4-%25d0%25ba%25d0%25b0%25d0%25bd%25d1%258c%25d0%25be%25d0%25bd-%25d0%25bd%25d0%25b0-%25d0%25bf%25d1%2583%25d1%2582%25d0%25b8-%25d0%25ba-%25d0%25b4%25d0%25be%25d0%25bc%25d0%25b5%25d0%25bd%25d0%25bd%25d0%25be%25d0%25bc%25d1%2583-%25d0%25b0%25d0%25b4%25d0%25bc%25d0%25b8%25d0%25bd%2F&linkname=%D0%93%D1%80%D0%B0%D0%BD%D0%B4-%D0%9A%D0%B0%D0%BD%D1%8C%D0%BE%D0%BD%20%D0%BD%D0%B0%20%D0%BF%D1%83%D1%82%D0%B8%20%D0%BA%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D0%BE%D0%BC%D1%83%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D1%83" title="Google+" rel="nofollow" target="_blank"></a><a class="a2a_button_linkedin" href="http://www.addtoany.com/add_to/linkedin?linkurl=https%3A%2F%2Fblog.styran.com%2F2009%2F12%2F%25d0%25b3%25d1%2580%25d0%25b0%25d0%25bd%25d0%25b4-%25d0%25ba%25d0%25b0%25d0%25bd%25d1%258c%25d0%25be%25d0%25bd-%25d0%25bd%25d0%25b0-%25d0%25bf%25d1%2583%25d1%2582%25d0%25b8-%25d0%25ba-%25d0%25b4%25d0%25be%25d0%25bc%25d0%25b5%25d0%25bd%25d0%25bd%25d0%25be%25d0%25bc%25d1%2583-%25d0%25b0%25d0%25b4%25d0%25bc%25d0%25b8%25d0%25bd%2F&linkname=%D0%93%D1%80%D0%B0%D0%BD%D0%B4-%D0%9A%D0%B0%D0%BD%D1%8C%D0%BE%D0%BD%20%D0%BD%D0%B0%20%D0%BF%D1%83%D1%82%D0%B8%20%D0%BA%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D0%BE%D0%BC%D1%83%20%D0%B0%D0%B4%D0%BC%D0%B8%D0%BD%D1%83" title="LinkedIn" rel="nofollow" target="_blank"></a><a class="a2a_dd addtoany_share_save" href="https://www.addtoany.com/share"></a>
  </div>
</div>